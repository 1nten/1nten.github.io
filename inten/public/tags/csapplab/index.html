<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CSAPPLAB | intenã®blogğŸ¦</title><meta name=keywords content><meta name=description content><meta name=author content><link rel=canonical href=https://inten.kro1lsec.com/tags/csapplab/><link crossorigin=anonymous href=/assets/css/stylesheet.min.84cc6e7cd97516a4d4e877c6bebe5a4529afdf61f4d009e2c8bbec3a876fff4e.css integrity="sha256-hMxufNl1FqTU6HfGvr5aRSmv32H00AniyLvsOodv/04=" rel="preload stylesheet" as=style><link rel=icon href=https://inten.kro1lsec.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://inten.kro1lsec.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://inten.kro1lsec.com/favicon-32x32.png><link rel=apple-touch-icon href=https://inten.kro1lsec.com/apple-touch-icon.png><link rel=mask-icon href=https://inten.kro1lsec.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><link rel=alternate type=application/rss+xml href=https://inten.kro1lsec.com/tags/csapplab/index.xml><meta property="og:title" content="CSAPPLAB"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://inten.kro1lsec.com/tags/csapplab/"><meta name=twitter:card content="summary"><meta name=twitter:title content="CSAPPLAB"><meta name=twitter:description content></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://inten.kro1lsec.com/ accesskey=h title="intenã®blogğŸ¦ (Alt + H)">intenã®blogğŸ¦</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://inten.kro1lsec.com/archives title=Archive><span>Archive</span></a></li><li><a href=https://inten.kro1lsec.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://inten.kro1lsec.com/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><header class=page-header><h1>CSAPPLAB</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>[CSAPPLAB]Attack Lab</h2></header><section class=entry-content><p>ctarget é¦–å…ˆæ‰§è¡Œgetbufå‡½æ•°ï¼Œè¯»å–æ ‡å‡†è¾“å…¥ã€‚
unsigned getbuf() { char buf[BUFFER_SIZE]; Gets(buf); return 1; } å‚æ•° (ctargetå’Œrtargetéƒ½æœ‰) -q ä¸å‘é€æˆç»© -i ä»æ–‡ä»¶ä¸­è¾“å…¥ å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨-qï¼Œå°±ä¼šå‡ºç°
FAILED: Initialization error: Running on an illegal host [localhost.localdomain] å› ä¸ºä½ æ²¡æœ‰ä½¿ç”¨CMUçš„å†…ç½‘ï¼Œæ˜¯æ— æ³•å»ºç«‹è¿æ¥çš„ã€‚æ‰€ä»¥æ¯æ¬¡è¿›è¡Œæ“ä½œéƒ½è¦å¸¦ä¸Š-qã€‚ä¹Ÿå¯ä»¥ç”¨qiã€‚
1.1level 1 è§‚å¯Ÿtestï¼Œgetbufå’Œtouch1
ç›®çš„ï¼šå°†getbufçš„è¿”å›åœ°å€ç”±testæ”¹ä¸ºtouch1
å°å»ºè®®
åˆ©ç”¨objdump -d ./ctarget>>ctarget.så¾—åˆ°æ±‡ç¼–ä»£ç  æ€è·¯æ˜¯å°†touch1çš„å¼€å§‹åœ°å€ï¼Œæ”¾åœ¨æŸä¸ªä½ç½®ï¼Œä»¥å®ç°å½“retæŒ‡ä»¤è¢«getbufæ‰§è¡Œåä¼šå°†æ§åˆ¶æƒè½¬ç§»ç»™touch1 ä¸€å®šè¦æ³¨æ„å­—èŠ‚åº ä½ å¯ä»¥ä½¿ç”¨gdbè®¾ç½®æ–­ç‚¹æ¥è¿›è¡Œè°ƒè¯•ã€‚å¹¶ä¸”gccä¼šå½±å“æ ˆå¸§ä¸­bufå­˜æ”¾çš„ä½ç½®ã€‚éœ€è¦æ³¨æ„ æ€è·¯ï¼šgetbufå‡½æ•°æ‰§è¡ŒretæŒ‡ä»¤åï¼Œå°±ä¼šä»%rsp+40å¤„è·å–è¿”å›åœ°å€ï¼Œåªè¦æˆ‘ä»¬ä¿®æ”¹è¿™ä¸ªè¿”å›åœ°å€ï¼Œæ”¹ä¸ºtouch1çš„åœ°å€ï¼Œå°±èƒ½ä½¿ç¨‹åºè¿”å›touch1ï¼Œè€Œä¸æ˜¯testã€‚
(gdb) p (char*)0x403188 #p(print) 0x403188ä¸Šå­˜çš„å€¼ $1 = 0x403188 "No exploit. Getbuf returned 0x%x\n" stack : padding(00..) + touch1(0x4017c0)
æ”»å‡»åºåˆ—touch1.txt
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c0 17 40 00 00 00 00 00 ä¿å­˜åœ¨touch1....</p></section><footer class=entry-footer>May 20, 2021&nbsp;Â·&nbsp;5 min</footer><a class=entry-link aria-label="post link to [CSAPPLAB]Attack Lab" href=https://inten.kro1lsec.com/post/csapplabattack-lab/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>[CSAPPLAB]Bomb Lab</h2></header><section class=entry-content><p>æ€»ä½“æ„Ÿè§‰è€ƒæŸ¥å¯¹æ±‡ç¼–çš„ç†è§£å’Œç†Ÿç»ƒåº¦
phase_1 400e37: 48 89 c7 mov %rax,%rdi //ç¬¬ä¸€ä¸ªå‚æ•° 400e3a: e8 a1 00 00 00 callq 400ee0 &lt;phase_1>
...
0x0000000000400ee0 &lt;+0>: sub $0x8,%rsp 0x0000000000400ee4 &lt;+4>: mov $0x402400,%esi //ç¬¬äºŒä¸ªå‚æ•°
0x0000000000400ee9 &lt;+9>: callq 0x401338 &lt;strings_not_equal>
è®©å‚æ•°ä¸€ï¼ŒäºŒç›¸ç­‰å³å¯
Border relations with Canada have never been better.
phase_2 åˆ©ç”¨callq 0x40145c &lt;read_six_numbers>ç¡®å®šå­—ç¬¦ä¸²æ ¼å¼ï¼Œ
åˆ©ç”¨0000000000400F1A add eax, eaxè®©åè¾¹çš„æ•°ç¿»å€
å­—ç¬¦ä¸²ä¸ºâ€œ1 2 4 8 16 32â€
phase_3 å°è¯•åˆ†ææ—¶ï¼Œå‘ç°jccæŒ‡ä»¤ç»å¸¸å¼„æ··ï¼Œåˆå›å»å¤ä¹ äº†ä¸€é
cmp oprd1,oprd2 + JNBE/JA æ— ç¬¦å·
cmp oprd1,oprd2 + JNLE/JG æœ‰ç¬¦å·
oprd1>oprd2æ—¶è·³è½¬
JZ/JE ç›¸ç­‰åˆ™è·³è½¬
ä»£ç ä¸­0x402470+8*ç¬¬ä¸€å‚æ•°æ‰“å°å†…å­˜ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°ç›¸åº”çš„è·³è½¬åœ°å€ï¼Œå·²ç»å¯¹åº”çš„eaxå€¼åº”è¯¥æ˜¯å¤šå°‘ï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒæ•°å­—çš„åº”è¯¥çš„å–å€¼ã€‚æ‰“å°å†…å­˜ä¿¡æ¯çš„å‘½ä»¤è¡Œä¸ºjmp QWORD PTR [rax*8+0x402470]...</p></section><footer class=entry-footer>April 15, 2021&nbsp;Â·&nbsp;4 min</footer><a class=entry-link aria-label="post link to [CSAPPLAB]Bomb Lab" href=https://inten.kro1lsec.com/post/csapplabbomb-lab/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>[CSAPPLAB]Data lab</h2></header><section class=entry-content><p>å‰ç½®çŸ¥è¯† csappç¬¬äºŒç« 
ä½è¿ç®—ç¬¦
è¿ç®—ç¬¦ æè¿° å®ä¾‹ & æŒ‰ä½ä¸æ“ä½œï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œ"ä¸"è¿ç®—ã€‚è¿ç®—è§„åˆ™ï¼š0&0=0; 0&1=0; 1&0=0; 1&1=1; (A & B) å°†å¾—åˆ° 12ï¼Œå³ä¸º 0000 1100 | æŒ‰ä½æˆ–è¿ç®—ç¬¦ï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œ"æˆ–"è¿ç®—ã€‚è¿ç®—è§„åˆ™ï¼š`0 0=0; 0 ^ å¼‚æˆ–è¿ç®—ç¬¦ï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œ"å¼‚æˆ–"è¿ç®—ã€‚è¿ç®—è§„åˆ™ï¼š0^0=0; 0^1=1; 1^0=1; 1^1=0; (A ^ B) å°†å¾—åˆ° 49ï¼Œå³ä¸º 0011 0001 ~ å–åè¿ç®—ç¬¦ï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œ"å–å"è¿ç®—ã€‚è¿ç®—è§„åˆ™ï¼š~1=-2; ~0=-1; (~A ) å°†å¾—åˆ° -61ï¼Œå³ä¸º 1100 0011ï¼Œä¸€ä¸ªæœ‰ç¬¦å·äºŒè¿›åˆ¶æ•°çš„è¡¥ç å½¢å¼ã€‚ Â« äºŒè¿›åˆ¶å·¦ç§»è¿ç®—ç¬¦ã€‚å°†ä¸€ä¸ªè¿ç®—å¯¹è±¡çš„å„äºŒè¿›åˆ¶ä½å…¨éƒ¨å·¦ç§»è‹¥å¹²ä½ï¼ˆå·¦è¾¹çš„äºŒè¿›åˆ¶ä½ä¸¢å¼ƒï¼Œå³è¾¹è¡¥0ï¼‰ã€‚ A Â« 2 å°†å¾—åˆ° 240ï¼Œå³ä¸º 1111 0000 Â» äºŒè¿›åˆ¶å³ç§»è¿ç®—ç¬¦ã€‚å°†ä¸€ä¸ªæ•°çš„å„äºŒè¿›åˆ¶ä½å…¨éƒ¨å³ç§»è‹¥å¹²ä½ï¼Œæ­£æ•°å·¦è¡¥0ï¼Œè´Ÿæ•°å·¦è¡¥1ï¼Œå³è¾¹ä¸¢å¼ƒã€‚ A Â» 2 å°†å¾—åˆ° 15ï¼Œå³ä¸º 0000 1111 è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§...</p></section><footer class=entry-footer>April 11, 2021&nbsp;Â·&nbsp;4 min</footer><a class=entry-link aria-label="post link to [CSAPPLAB]Data lab" href=https://inten.kro1lsec.com/post/csapplabdata-lab/></a></article></main><footer class=footer><span>&copy; 2021 <a href=https://inten.kro1lsec.com/>intenã®blogğŸ¦</a></span>
<span>&#183;</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>