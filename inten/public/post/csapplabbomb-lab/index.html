<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[CSAPPLAB]Bomb Lab | intenã®blogğŸ¦</title><meta name=keywords content="CSAPPLAB,å¤©é—®ä¹‹è·¯"><meta name=description content="æ€»ä½“æ„Ÿè§‰è€ƒæŸ¥å¯¹æ±‡ç¼–çš„ç†è§£å’Œç†Ÿç»ƒåº¦
phase_1 400e37: 48 89 c7 mov %rax,%rdi //ç¬¬ä¸€ä¸ªå‚æ•° 400e3a: e8 a1 00 00 00 callq 400ee0 <phase_1>...0x0000000000400ee0 <+0>: sub $0x8,%rsp 0x0000000000400ee4 <+4>: mov $0x402400,%esi //ç¬¬äºŒä¸ªå‚æ•°0x0000000000400ee9 <+9>: callq 0x401338 <strings_not_equal>è®©å‚æ•°ä¸€ï¼ŒäºŒç›¸ç­‰å³å¯
Border relations with Canada have never been better.
phase_2 åˆ©ç”¨callq 0x40145c <read_six_numbers>ç¡®å®šå­—ç¬¦ä¸²æ ¼å¼ï¼Œ
åˆ©ç”¨0000000000400F1A add eax, eaxè®©åè¾¹çš„æ•°ç¿»å€
å­—ç¬¦ä¸²ä¸ºâ€œ1 2 4 8 16 32â€
phase_3 å°è¯•åˆ†ææ—¶ï¼Œå‘ç°jccæŒ‡ä»¤ç»å¸¸å¼„æ··ï¼Œåˆå›å»å¤ä¹ äº†ä¸€é
cmp oprd1,oprd2 + JNBE/JA æ— ç¬¦å·cmp oprd1,oprd2 + JNLE/JG æœ‰ç¬¦å·oprd1>oprd2æ—¶è·³è½¬JZ/JE ç›¸ç­‰åˆ™è·³è½¬ä»£ç ä¸­0x402470+8*ç¬¬ä¸€å‚æ•°æ‰“å°å†…å­˜ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°ç›¸åº”çš„è·³è½¬åœ°å€ï¼Œå·²ç»å¯¹åº”çš„eaxå€¼åº”è¯¥æ˜¯å¤šå°‘ï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒæ•°å­—çš„åº”è¯¥çš„å–å€¼ã€‚æ‰“å°å†…å­˜ä¿¡æ¯çš„å‘½ä»¤è¡Œä¸ºjmp QWORD PTR [rax*8+0x402470]"><meta name=author content><link rel=canonical href=https://inten.kro1lsec.com/post/csapplabbomb-lab/><link crossorigin=anonymous href=/assets/css/stylesheet.min.84cc6e7cd97516a4d4e877c6bebe5a4529afdf61f4d009e2c8bbec3a876fff4e.css integrity="sha256-hMxufNl1FqTU6HfGvr5aRSmv32H00AniyLvsOodv/04=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://inten.kro1lsec.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://inten.kro1lsec.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://inten.kro1lsec.com/favicon-32x32.png><link rel=apple-touch-icon href=https://inten.kro1lsec.com/apple-touch-icon.png><link rel=mask-icon href=https://inten.kro1lsec.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><meta property="og:title" content="[CSAPPLAB]Bomb Lab"><meta property="og:description" content="æ€»ä½“æ„Ÿè§‰è€ƒæŸ¥å¯¹æ±‡ç¼–çš„ç†è§£å’Œç†Ÿç»ƒåº¦
phase_1 400e37: 48 89 c7 mov %rax,%rdi //ç¬¬ä¸€ä¸ªå‚æ•° 400e3a: e8 a1 00 00 00 callq 400ee0 <phase_1>...0x0000000000400ee0 <+0>: sub $0x8,%rsp 0x0000000000400ee4 <+4>: mov $0x402400,%esi //ç¬¬äºŒä¸ªå‚æ•°0x0000000000400ee9 <+9>: callq 0x401338 <strings_not_equal>è®©å‚æ•°ä¸€ï¼ŒäºŒç›¸ç­‰å³å¯
Border relations with Canada have never been better.
phase_2 åˆ©ç”¨callq 0x40145c <read_six_numbers>ç¡®å®šå­—ç¬¦ä¸²æ ¼å¼ï¼Œ
åˆ©ç”¨0000000000400F1A add eax, eaxè®©åè¾¹çš„æ•°ç¿»å€
å­—ç¬¦ä¸²ä¸ºâ€œ1 2 4 8 16 32â€
phase_3 å°è¯•åˆ†ææ—¶ï¼Œå‘ç°jccæŒ‡ä»¤ç»å¸¸å¼„æ··ï¼Œåˆå›å»å¤ä¹ äº†ä¸€é
cmp oprd1,oprd2 + JNBE/JA æ— ç¬¦å·cmp oprd1,oprd2 + JNLE/JG æœ‰ç¬¦å·oprd1>oprd2æ—¶è·³è½¬JZ/JE ç›¸ç­‰åˆ™è·³è½¬ä»£ç ä¸­0x402470+8*ç¬¬ä¸€å‚æ•°æ‰“å°å†…å­˜ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°ç›¸åº”çš„è·³è½¬åœ°å€ï¼Œå·²ç»å¯¹åº”çš„eaxå€¼åº”è¯¥æ˜¯å¤šå°‘ï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒæ•°å­—çš„åº”è¯¥çš„å–å€¼ã€‚æ‰“å°å†…å­˜ä¿¡æ¯çš„å‘½ä»¤è¡Œä¸ºjmp QWORD PTR [rax*8+0x402470]"><meta property="og:type" content="article"><meta property="og:url" content="https://inten.kro1lsec.com/post/csapplabbomb-lab/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-04-15T15:07:34+08:00"><meta property="article:modified_time" content="2021-04-15T15:07:34+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="[CSAPPLAB]Bomb Lab"><meta name=twitter:description content="æ€»ä½“æ„Ÿè§‰è€ƒæŸ¥å¯¹æ±‡ç¼–çš„ç†è§£å’Œç†Ÿç»ƒåº¦
phase_1 400e37: 48 89 c7 mov %rax,%rdi //ç¬¬ä¸€ä¸ªå‚æ•° 400e3a: e8 a1 00 00 00 callq 400ee0 <phase_1>...0x0000000000400ee0 <+0>: sub $0x8,%rsp 0x0000000000400ee4 <+4>: mov $0x402400,%esi //ç¬¬äºŒä¸ªå‚æ•°0x0000000000400ee9 <+9>: callq 0x401338 <strings_not_equal>è®©å‚æ•°ä¸€ï¼ŒäºŒç›¸ç­‰å³å¯
Border relations with Canada have never been better.
phase_2 åˆ©ç”¨callq 0x40145c <read_six_numbers>ç¡®å®šå­—ç¬¦ä¸²æ ¼å¼ï¼Œ
åˆ©ç”¨0000000000400F1A add eax, eaxè®©åè¾¹çš„æ•°ç¿»å€
å­—ç¬¦ä¸²ä¸ºâ€œ1 2 4 8 16 32â€
phase_3 å°è¯•åˆ†ææ—¶ï¼Œå‘ç°jccæŒ‡ä»¤ç»å¸¸å¼„æ··ï¼Œåˆå›å»å¤ä¹ äº†ä¸€é
cmp oprd1,oprd2 + JNBE/JA æ— ç¬¦å·cmp oprd1,oprd2 + JNLE/JG æœ‰ç¬¦å·oprd1>oprd2æ—¶è·³è½¬JZ/JE ç›¸ç­‰åˆ™è·³è½¬ä»£ç ä¸­0x402470+8*ç¬¬ä¸€å‚æ•°æ‰“å°å†…å­˜ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°ç›¸åº”çš„è·³è½¬åœ°å€ï¼Œå·²ç»å¯¹åº”çš„eaxå€¼åº”è¯¥æ˜¯å¤šå°‘ï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒæ•°å­—çš„åº”è¯¥çš„å–å€¼ã€‚æ‰“å°å†…å­˜ä¿¡æ¯çš„å‘½ä»¤è¡Œä¸ºjmp QWORD PTR [rax*8+0x402470]"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://inten.kro1lsec.com/post/"},{"@type":"ListItem","position":2,"name":"[CSAPPLAB]Bomb Lab","item":"https://inten.kro1lsec.com/post/csapplabbomb-lab/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[CSAPPLAB]Bomb Lab","name":"[CSAPPLAB]Bomb Lab","description":"æ€»ä½“æ„Ÿè§‰è€ƒæŸ¥å¯¹æ±‡ç¼–çš„ç†è§£å’Œç†Ÿç»ƒåº¦\nphase_1 400e37: 48 89 c7 mov %rax,%rdi //ç¬¬ä¸€ä¸ªå‚æ•° 400e3a: e8 a1 00 00 00 callq 400ee0 \u0026lt;phase_1\u0026gt;\r...\r0x0000000000400ee0 \u0026lt;+0\u0026gt;: sub $0x8,%rsp 0x0000000000400ee4 \u0026lt;+4\u0026gt;: mov $0x402400,%esi //ç¬¬äºŒä¸ªå‚æ•°\r0x0000000000400ee9 \u0026lt;+9\u0026gt;: callq 0x401338 \u0026lt;strings_not_equal\u0026gt;\rè®©å‚æ•°ä¸€ï¼ŒäºŒç›¸ç­‰å³å¯\nBorder relations with Canada have never been better.\nphase_2 åˆ©ç”¨callq 0x40145c \u0026lt;read_six_numbers\u0026gt;ç¡®å®šå­—ç¬¦ä¸²æ ¼å¼ï¼Œ\nåˆ©ç”¨0000000000400F1A add eax, eaxè®©åè¾¹çš„æ•°ç¿»å€\nå­—ç¬¦ä¸²ä¸ºâ€œ1 2 4 8 16 32â€\nphase_3 å°è¯•åˆ†ææ—¶ï¼Œå‘ç°jccæŒ‡ä»¤ç»å¸¸å¼„æ··ï¼Œåˆå›å»å¤ä¹ äº†ä¸€é\ncmp oprd1,oprd2 + JNBE/JA æ— ç¬¦å·\rcmp oprd1,oprd2 + JNLE/JG æœ‰ç¬¦å·\roprd1\u0026gt;oprd2æ—¶è·³è½¬\rJZ/JE ç›¸ç­‰åˆ™è·³è½¬\rä»£ç ä¸­0x402470+8*ç¬¬ä¸€å‚æ•°æ‰“å°å†…å­˜ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°ç›¸åº”çš„è·³è½¬åœ°å€ï¼Œå·²ç»å¯¹åº”çš„eaxå€¼åº”è¯¥æ˜¯å¤šå°‘ï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒæ•°å­—çš„åº”è¯¥çš„å–å€¼ã€‚æ‰“å°å†…å­˜ä¿¡æ¯çš„å‘½ä»¤è¡Œä¸ºjmp QWORD PTR [rax*8+0x402470]","keywords":["CSAPPLAB","å¤©é—®ä¹‹è·¯"],"articleBody":"æ€»ä½“æ„Ÿè§‰è€ƒæŸ¥å¯¹æ±‡ç¼–çš„ç†è§£å’Œç†Ÿç»ƒåº¦\nphase_1 400e37: 48 89 c7 mov %rax,%rdi //ç¬¬ä¸€ä¸ªå‚æ•° 400e3a: e8 a1 00 00 00 callq 400ee0 \r...\r0x0000000000400ee0 : sub $0x8,%rsp 0x0000000000400ee4 : mov $0x402400,%esi //ç¬¬äºŒä¸ªå‚æ•°\r0x0000000000400ee9 : callq 0x401338 \rè®©å‚æ•°ä¸€ï¼ŒäºŒç›¸ç­‰å³å¯\nBorder relations with Canada have never been better.\nphase_2 åˆ©ç”¨callq 0x40145c ç¡®å®šå­—ç¬¦ä¸²æ ¼å¼ï¼Œ\nåˆ©ç”¨0000000000400F1A add eax, eaxè®©åè¾¹çš„æ•°ç¿»å€\nå­—ç¬¦ä¸²ä¸ºâ€œ1 2 4 8 16 32â€\nphase_3 å°è¯•åˆ†ææ—¶ï¼Œå‘ç°jccæŒ‡ä»¤ç»å¸¸å¼„æ··ï¼Œåˆå›å»å¤ä¹ äº†ä¸€é\ncmp oprd1,oprd2 + JNBE/JA æ— ç¬¦å·\rcmp oprd1,oprd2 + JNLE/JG æœ‰ç¬¦å·\roprd1oprd2æ—¶è·³è½¬\rJZ/JE ç›¸ç­‰åˆ™è·³è½¬\rä»£ç ä¸­0x402470+8*ç¬¬ä¸€å‚æ•°æ‰“å°å†…å­˜ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°ç›¸åº”çš„è·³è½¬åœ°å€ï¼Œå·²ç»å¯¹åº”çš„eaxå€¼åº”è¯¥æ˜¯å¤šå°‘ï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒæ•°å­—çš„åº”è¯¥çš„å–å€¼ã€‚æ‰“å°å†…å­˜ä¿¡æ¯çš„å‘½ä»¤è¡Œä¸ºjmp QWORD PTR [rax*8+0x402470]\n0 207 ===ã€‹x/x (int *)0x402470 æ‰“å°å¾—åˆ°åœ°å€400f7c\r1 311 ===ã€‹x/x (int *)0x402478 æ‰“å°å¾—åˆ°åœ°å€400fb9\r2 707 ===ã€‹x/x (int *)0x402480 æ‰“å°å¾—åˆ°åœ°å€400f83\r3 256 ===ã€‹x/x (int *)0x402488 æ‰“å°å¾—åˆ°åœ°å€400f8a\r4 389 ===ã€‹x/x (int *)0x402490 æ‰“å°å¾—åˆ°åœ°å€400f91\r5 206 ===ã€‹x/x (int *)0x402498 æ‰“å°å¾—åˆ°åœ°å€400f98\r6 682 ===ã€‹x/x (int *)0x4024a0 æ‰“å°å¾—åˆ°åœ°å€400f9f\r7 327 ===ã€‹x/x (int *)0x4024a8 æ‰“å°å¾—åˆ°åœ°å€400fa6\r phase_4 ; __unwind {\rsub rsp, 18h\rlea rcx, [rsp+18h+var_C]\rlea rdx, [rsp+18h+var_10]\rmov esi, offset aDD ; \"%d %d\"\rmov eax, 0\rcall ___isoc99_sscanf\rcmp eax, 2 //éœ€è¦è¾“å…¥2ä¸ªæ•°å­—\rjnz short loc_401035 //JNZ/JNE ä¸ä¸º0è·³è½¬,ä¸ç›¸ç­‰è·³è½¬ if (i != j);if (i != 0);\rcmp [rsp+18h+var_10], 0Eh\rjbe short loc_40103A\r//JBE/JNA if (i åˆ†æå‡½æ•°å¯çŸ¥ç¬¬äºŒä¸ªå‚æ•°çš„ä¸º0\nå¯†ç ä¸º0 0\nphase_5 ä¸¤ç§ä¸åŒçš„æ±‡ç¼–çœ‹å¾—è¿˜ä¸ä¹ æƒ¯ï¼Œè´´äº†idaä¸­çš„å†™æ³•\n401089: eb 47 jmp 4010d2 \r000000000040108B movzx ecx, byte ptr [rbx+rax]\r40108b: 0f b6 0c 03 movzbl (%rbx,%rax,1),%ecx //å°†è¾“å…¥å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ç»™ecx\r40108f: 88 0c 24 mov %cl,(%rsp)\r401092: 48 8b 14 24 mov (%rsp),%rdx\r401096: 83 e2 0f and $0xf,%edx //å–å­—ç¬¦çš„æœ€ä½4ä½åˆ°edxï¼Œå¤§å°ä»0~15\r0000000000401099 movzx edx, ds:array_3449[rdx]\r401099: 0f b6 92 b0 24 40 00 movzbl 0x4024b0(%rdx),%edx //æ ¹æ®rdxä¸­çš„æ•°å­—ï¼Œä»0x4024b0(%rdx)ä¸­å–å­—ç¬¦\r//maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?\r4010a0: 88 54 04 10 mov %dl,0x10(%rsp,%rax,1) //å­˜å‚¨å–å‡ºçš„å­—ç¬¦\r4010a4: 48 83 c0 01 add $0x1,%rax //å¤„ç†æ¬¡æ•°+1\r4010a8: 48 83 f8 06 cmp $0x6,%rax //åˆ¤æ–­å¤„ç†æ¬¡æ•°æ˜¯å¦åˆ°6æ¬¡\r4010ac: 75 dd jne 40108b \r4010ae: c6 44 24 16 00 movb $0x0,0x16(%rsp) //ä¸ºæ–°åˆ›å»ºçš„å­—ç¬¦ä¸²æ·»åŠ ç»“å°¾ç¬¦â€œ/0â€\r4010b3: be 5e 24 40 00 mov $0x40245e,%esi // flyers\r4010b8: 48 8d 7c 24 10 lea 0x10(%rsp),%rdi //æ¯”è¾ƒæ–°åˆ›å»ºçš„å­—ç¬¦ä¸²ä¸flyersæ˜¯å¦ç›¸ç­‰\r4010bd: e8 76 02 00 00 callq 401338 \r4010c2: 85 c0 test %eax,%eax\r4010c4: 74 13 je 4010d9 \r4010c6: e8 6f 03 00 00 callq 40143a \r00000000004010CB align 10h\r4010cb: 0f 1f 44 00 00 nopl 0x0(%rax,%rax,1)\r4010d0: eb 07 jmp 4010d9 \r4010d2: b8 00 00 00 00 mov $0x0,%eax\r4010d7: eb b2 jmp 40108b \rpwndbg p/s (char*)0x4024b0 $1 = 0x4024b0  \"maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?\" fï¼ˆ9ï¼‰ï¼Œlï¼ˆ15ï¼‰ï¼Œyï¼ˆ14ï¼‰ï¼Œeï¼ˆ5ï¼‰ï¼Œrï¼ˆ6ï¼‰ï¼Œsï¼ˆ7ï¼‰\nç­”æ¡ˆä¸ºï¼š\nionefgï¼ˆ0x49ï¼Œ0x4f,0x4E,0x45,0x46,0x47ï¼‰\rphase_6 callq 40145c \næˆ‘ä»¬éœ€è¦è¾“å…¥çš„6ä½æ•°å­—ï¼Œä¸”éƒ½å°äº6\nwhileå¾ªç¯\n401128: 41 83 c4 01 add $0x1,%r12d //r12dè®¡æ•°\r40112c: 41 83 fc 06 cmp $0x6,%r12d //è®¡æ•°å°äº6\r401130: 74 21 je 401153 \r401132: 44 89 e3 mov %r12d,%ebx\r401135: 48 63 c3 movslq %ebx,%rax\r401138: 8b 04 84 mov (%rsp,%rax,4),%eax\r40113b: 39 45 00 cmp %eax,0x0(%rbp) //==åˆ¤æ–­æ¯ä¸ªæ•°å­—éƒ½ä¸ç­‰äº 0\r40113e: 75 05 jne 401145 \r401140: e8 f5 02 00 00 callq 40143a \r401145: 83 c3 01 add $0x1,%ebx\r401148: 83 fb 05 cmp $0x5,%ebx\r40114b: 7e e8 jle 401135 \rè¦ç”¨7å‡å®Œçš„åºåˆ—åšç´¢å¼•ä»é“¾è¡¨å–æ•°ï¼Œæ¯”è¾ƒå¤§å°ã€‚ä»å¤§åˆ°å°æ’åºã€‚\n3 4 5 6 1 2\nç”¨7å‡å®Œ\n4 3 2 1 6 5\nsecret_phase é€’å½’è°ƒç”¨äººé€†å‚»äº†ï¼Œå‚è€ƒä¸›ä¸›çš„è„šæœ¬çˆ†ç ´\nå¤§è‡´æ€è·¯æ˜¯å®šä½åˆ°ifè¯­å¥ä¸­å‚æ•°çš„åœ°å€6030F0ï¼Œå†ç…§ç€åŸå‡½æ•°çš„é€»è¾‘çˆ†ç ´ã€‚\ndata = '''0x6030f0,0x0000000000000024,0x0000000000603110 0x603100,0x0000000000603130,0x0000000000000000 0x603110,0x0000000000000008,0x0000000000603190 0x603120,0x0000000000603150,0x0000000000000000 0x603130,0x0000000000000032,0x0000000000603170 0x603140,0x00000000006031b0,0x0000000000000000 0x603150,0x0000000000000016,0x0000000000603270 0x603160,0x0000000000603230,0x0000000000000000 0x603170,0x000000000000002d,0x00000000006031d0 0x603180,0x0000000000603290,0x0000000000000000 0x603190,0x0000000000000006,0x00000000006031f0 0x6031a0,0x0000000000603250,0x0000000000000000 0x6031b0,0x000000000000006b,0x0000000000603210 0x6031c0,0x00000000006032b0,0x0000000000000000 0x6031d0,0x0000000000000028,0x0000000000000000 0x6031e0,0x0000000000000000,0x0000000000000000 0x6031f0,0x0000000000000001,0x0000000000000000 0x603200,0x0000000000000000,0x0000000000000000 0x603210,0x0000000000000063,0x0000000000000000 0x603220,0x0000000000000000,0x0000000000000000 0x603230,0x0000000000000023,0x0000000000000000 0x603240,0x0000000000000000,0x0000000000000000 0x603250,0x0000000000000007,0x0000000000000000 0x603260,0x0000000000000000,0x0000000000000000 0x603270,0x0000000000000014,0x0000000000000000 0x603280,0x0000000000000000,0x0000000000000000 0x603290,0x000000000000002f,0x0000000000000000 0x6032a0,0x0000000000000000,0x0000000000000000 0x6032b0,0x00000000000003e9,0x0000000000000000 0x6032c0,0x0000000000000000,0x0000000000000000''' data_dict = {} fin_dict = {} def data_collect(): data_list = data.split(\"\\n\") last_try = 0 for i in data_list: #print i x = i.split(\",\") x = [int(i,16) for i in x] if x[1]0x600000 and x[1]0: data_dict[x[0]] = [x[1],x[2],0] last_try = x[0] else: data_dict[last_try][2] = x[1] for k in data_dict.values(): if k[1] == 0: if k[2] == 0: fin_dict[k[0]] = [0,0] else: fin_dict[k[0]] = [0,data_dict[k[2]][0]] else: if k[2] == 0: fin_dict[k[0]] = [data_dict[k[1]][0],0] else: fin_dict[k[0]] = [data_dict[k[1]][0],data_dict[k[2]][0]] data_collect() def func(num,i): if num == 0: return -1 if i == num: result = 0 return result if inum: next_num = fin_dict[num][1] result = func(next_num,i) result = result+result+1 return result if inum: next_num = fin_dict[num][0] result = func(next_num,i) result *= 2 return result for i in range(1000): if func(0x24,i) == 2: print i ","wordCount":"660","inLanguage":"en","datePublished":"2021-04-15T15:07:34+08:00","dateModified":"2021-04-15T15:07:34+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://inten.kro1lsec.com/post/csapplabbomb-lab/"},"publisher":{"@type":"Organization","name":"intenã®blogğŸ¦","logo":{"@type":"ImageObject","url":"https://inten.kro1lsec.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://inten.kro1lsec.com/ accesskey=h title="intenã®blogğŸ¦ (Alt + H)">intenã®blogğŸ¦</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://inten.kro1lsec.com/archives title=Archive><span>Archive</span></a></li><li><a href=https://inten.kro1lsec.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://inten.kro1lsec.com/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>[CSAPPLAB]Bomb Lab</h1><div class=post-meta>April 15, 2021&nbsp;Â·&nbsp;4 min</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#phase_1 aria-label=phase_1>phase_1</a></li><li><a href=#phase_2 aria-label=phase_2>phase_2</a></li><li><a href=#phase_3 aria-label=phase_3>phase_3</a></li><li><a href=#phase_4 aria-label=phase_4>phase_4</a></li><li><a href=#phase_5 aria-label=phase_5>phase_5</a></li><li><a href=#phase_6 aria-label=phase_6>phase_6</a></li><li><a href=#secret_phase aria-label=secret_phase>secret_phase</a></li></ul></div></details></div><div class=post-content><p><img loading=lazy src=https://www.kro1lsec.com:442/images/2021/05/26/20210526141822.png alt=image-20210321154547297></p><p>æ€»ä½“æ„Ÿè§‰è€ƒæŸ¥å¯¹æ±‡ç¼–çš„ç†è§£å’Œç†Ÿç»ƒåº¦</p><h4 id=phase_1>phase_1<a hidden class=anchor aria-hidden=true href=#phase_1>#</a></h4><pre><code class=language-assembly data-lang=assembly>400e37:   48 89 c7                mov    %rax,%rdi    //ç¬¬ä¸€ä¸ªå‚æ•°  
400e3a:   e8 a1 00 00 00          callq  400ee0 &lt;phase_1&gt;
...
0x0000000000400ee0 &lt;+0&gt;:    sub    $0x8,%rsp 
0x0000000000400ee4 &lt;+4&gt;:    mov    $0x402400,%esi   //ç¬¬äºŒä¸ªå‚æ•°
0x0000000000400ee9 &lt;+9&gt;:    callq  0x401338 &lt;strings_not_equal&gt;
</code></pre><p>è®©å‚æ•°ä¸€ï¼ŒäºŒç›¸ç­‰å³å¯</p><p>Border relations with Canada have never been better.</p><h4 id=phase_2>phase_2<a hidden class=anchor aria-hidden=true href=#phase_2>#</a></h4><p>åˆ©ç”¨callq 0x40145c &lt;read_six_numbers>ç¡®å®šå­—ç¬¦ä¸²æ ¼å¼ï¼Œ</p><p>åˆ©ç”¨0000000000400F1A add eax, eaxè®©åè¾¹çš„æ•°ç¿»å€</p><p>å­—ç¬¦ä¸²ä¸ºâ€œ1 2 4 8 16 32â€</p><h4 id=phase_3>phase_3<a hidden class=anchor aria-hidden=true href=#phase_3>#</a></h4><p>å°è¯•åˆ†ææ—¶ï¼Œå‘ç°jccæŒ‡ä»¤ç»å¸¸å¼„æ··ï¼Œåˆå›å»å¤ä¹ äº†ä¸€é</p><pre><code class=language-assembly data-lang=assembly>cmp oprd1,oprd2 + JNBE/JA æ— ç¬¦å·
cmp oprd1,oprd2 + JNLE/JG æœ‰ç¬¦å·
oprd1&gt;oprd2æ—¶è·³è½¬
JZ/JE ç›¸ç­‰åˆ™è·³è½¬
</code></pre><p>ä»£ç ä¸­<code>0x402470+8*ç¬¬ä¸€å‚æ•°</code>æ‰“å°å†…å­˜ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°ç›¸åº”çš„è·³è½¬åœ°å€ï¼Œå·²ç»å¯¹åº”çš„eaxå€¼åº”è¯¥æ˜¯å¤šå°‘ï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒæ•°å­—çš„åº”è¯¥çš„å–å€¼ã€‚æ‰“å°å†…å­˜ä¿¡æ¯çš„å‘½ä»¤è¡Œä¸ºjmp QWORD PTR [rax*8+0x402470]</p><pre><code>0 207  ===ã€‹x/x (int *)0x402470 æ‰“å°å¾—åˆ°åœ°å€400f7c
1 311  ===ã€‹x/x (int *)0x402478 æ‰“å°å¾—åˆ°åœ°å€400fb9
2 707  ===ã€‹x/x (int *)0x402480 æ‰“å°å¾—åˆ°åœ°å€400f83
3 256  ===ã€‹x/x (int *)0x402488 æ‰“å°å¾—åˆ°åœ°å€400f8a
4 389  ===ã€‹x/x (int *)0x402490 æ‰“å°å¾—åˆ°åœ°å€400f91
5 206  ===ã€‹x/x (int *)0x402498 æ‰“å°å¾—åˆ°åœ°å€400f98
6 682  ===ã€‹x/x (int *)0x4024a0 æ‰“å°å¾—åˆ°åœ°å€400f9f
7 327  ===ã€‹x/x (int *)0x4024a8 æ‰“å°å¾—åˆ°åœ°å€400fa6
</code></pre><h4 id=phase_4>phase_4<a hidden class=anchor aria-hidden=true href=#phase_4>#</a></h4><pre><code class=language-assembly data-lang=assembly>; __unwind {
sub     rsp, 18h
lea     rcx, [rsp+18h+var_C]
lea     rdx, [rsp+18h+var_10]
mov     esi, offset aDD ; &quot;%d %d&quot;
mov     eax, 0
call    ___isoc99_sscanf
cmp     eax, 2                 //éœ€è¦è¾“å…¥2ä¸ªæ•°å­—
jnz     short loc_401035       
//JNZ/JNE   ä¸ä¸º0è·³è½¬,ä¸ç›¸ç­‰è·³è½¬ if (i != j);if (i != 0);
</code></pre><pre><code class=language-assembly data-lang=assembly>cmp     [rsp+18h+var_10], 0Eh
jbe     short loc_40103A
//JBE/JNA if (i &lt;= j);å¯çŸ¥ç¬¬ä¸€ä¸ªæ•°å­—&lt;=0xe
ã€‚ã€‚ã€‚
cmp     [rsp+18h+var_C], 0  //ç¬¬ä¸€ä¸ªå‚æ•°ä¸º0
jz      short loc_40105D
</code></pre><p>åˆ†æ<code>&lt;fun4></code>å‡½æ•°å¯çŸ¥ç¬¬äºŒä¸ªå‚æ•°çš„ä¸º0</p><p>å¯†ç ä¸º0 0</p><h4 id=phase_5>phase_5<a hidden class=anchor aria-hidden=true href=#phase_5>#</a></h4><p>ä¸¤ç§ä¸åŒçš„æ±‡ç¼–çœ‹å¾—è¿˜ä¸ä¹ æƒ¯ï¼Œè´´äº†idaä¸­çš„å†™æ³•</p><pre><code class=language-assembly data-lang=assembly>401089: eb 47                   jmp    4010d2 &lt;phase_5+0x70&gt;
000000000040108B                 movzx   ecx, byte ptr [rbx+rax]
40108b: 0f b6 0c 03             movzbl (%rbx,%rax,1),%ecx //å°†è¾“å…¥å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ç»™ecx
40108f: 88 0c 24                mov    %cl,(%rsp)
401092: 48 8b 14 24             mov    (%rsp),%rdx
401096: 83 e2 0f                and    $0xf,%edx     //å–å­—ç¬¦çš„æœ€ä½4ä½åˆ°edxï¼Œå¤§å°ä»0~15
0000000000401099                 movzx   edx, ds:array_3449[rdx]
401099: 0f b6 92 b0 24 40 00    movzbl 0x4024b0(%rdx),%edx   //æ ¹æ®rdxä¸­çš„æ•°å­—ï¼Œä»0x4024b0(%rdx)ä¸­å–å­—ç¬¦
//maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?

4010a0: 88 54 04 10             mov    %dl,0x10(%rsp,%rax,1) //å­˜å‚¨å–å‡ºçš„å­—ç¬¦
4010a4: 48 83 c0 01             add    $0x1,%rax  //å¤„ç†æ¬¡æ•°+1
4010a8: 48 83 f8 06             cmp    $0x6,%rax  //åˆ¤æ–­å¤„ç†æ¬¡æ•°æ˜¯å¦åˆ°6æ¬¡
4010ac: 75 dd                   jne    40108b &lt;phase_5+0x29&gt;
4010ae: c6 44 24 16 00          movb   $0x0,0x16(%rsp)   //ä¸ºæ–°åˆ›å»ºçš„å­—ç¬¦ä¸²æ·»åŠ ç»“å°¾ç¬¦â€œ/0â€
4010b3: be 5e 24 40 00          mov    $0x40245e,%esi  // flyers
4010b8: 48 8d 7c 24 10          lea    0x10(%rsp),%rdi //æ¯”è¾ƒæ–°åˆ›å»ºçš„å­—ç¬¦ä¸²ä¸flyersæ˜¯å¦ç›¸ç­‰
4010bd: e8 76 02 00 00          callq  401338 &lt;strings_not_equal&gt;
4010c2: 85 c0                   test   %eax,%eax
4010c4: 74 13                   je     4010d9 &lt;phase_5+0x77&gt;
4010c6: e8 6f 03 00 00          callq  40143a &lt;explode_bomb&gt;
00000000004010CB                 align 10h
4010cb: 0f 1f 44 00 00          nopl   0x0(%rax,%rax,1)
4010d0: eb 07                   jmp    4010d9 &lt;phase_5+0x77&gt;
4010d2: b8 00 00 00 00          mov    $0x0,%eax
4010d7: eb b2                   jmp    40108b &lt;phase_5+0x29&gt;
</code></pre><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>pwndbg&gt; p/s <span style=color:#f92672>(</span>char*<span style=color:#f92672>)</span>0x4024b0
$1 <span style=color:#f92672>=</span> 0x4024b0 &lt;array&gt; <span style=color:#e6db74>&#34;maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?&#34;</span>
</code></pre></div><p>fï¼ˆ9ï¼‰ï¼Œlï¼ˆ15ï¼‰ï¼Œyï¼ˆ14ï¼‰ï¼Œeï¼ˆ5ï¼‰ï¼Œrï¼ˆ6ï¼‰ï¼Œsï¼ˆ7ï¼‰</p><p>ç­”æ¡ˆä¸ºï¼š</p><pre><code>ionefgï¼ˆ0x49ï¼Œ0x4f,0x4E,0x45,0x46,0x47ï¼‰
</code></pre><h4 id=phase_6>phase_6<a hidden class=anchor aria-hidden=true href=#phase_6>#</a></h4><p>callq 40145c &lt;read_six_numbers></p><p>æˆ‘ä»¬éœ€è¦è¾“å…¥çš„6ä½æ•°å­—ï¼Œä¸”éƒ½å°äº6</p><p>whileå¾ªç¯</p><pre><code class=language-assembly data-lang=assembly> 401128:    41 83 c4 01             add    $0x1,%r12d     //r12dè®¡æ•°
 40112c:    41 83 fc 06             cmp    $0x6,%r12d     //è®¡æ•°å°äº6
401130: 74 21                   je     401153 &lt;phase_6+0x5f&gt;

401132: 44 89 e3                mov    %r12d,%ebx
401135: 48 63 c3                movslq %ebx,%rax

401138: 8b 04 84                mov    (%rsp,%rax,4),%eax
40113b: 39 45 00                cmp    %eax,0x0(%rbp) //==&gt;åˆ¤æ–­æ¯ä¸ªæ•°å­—éƒ½ä¸ç­‰äº 0
40113e: 75 05                   jne    401145 &lt;phase_6+0x51&gt;
401140: e8 f5 02 00 00          callq  40143a &lt;explode_bomb&gt;
401145: 83 c3 01                add    $0x1,%ebx
401148: 83 fb 05                cmp    $0x5,%ebx
40114b: 7e e8                   jle     401135 &lt;phase_6+0x41&gt;
</code></pre><p><img loading=lazy src=https://www.kro1lsec.com:442/images/2021/05/26/20210526141826.png alt=image-20210321150502162></p><p>è¦ç”¨7å‡å®Œçš„åºåˆ—åšç´¢å¼•ä»é“¾è¡¨å–æ•°ï¼Œæ¯”è¾ƒå¤§å°ã€‚ä»å¤§åˆ°å°æ’åºã€‚</p><p>3 4 5 6 1 2</p><p>ç”¨7å‡å®Œ</p><p>4 3 2 1 6 5</p><h4 id=secret_phase>secret_phase<a hidden class=anchor aria-hidden=true href=#secret_phase>#</a></h4><p>é€’å½’è°ƒç”¨äººé€†å‚»äº†ï¼Œå‚è€ƒä¸›ä¸›çš„è„šæœ¬çˆ†ç ´</p><p>å¤§è‡´æ€è·¯æ˜¯å®šä½åˆ°ifè¯­å¥ä¸­å‚æ•°çš„åœ°å€6030F0ï¼Œå†ç…§ç€åŸå‡½æ•°çš„é€»è¾‘çˆ†ç ´ã€‚</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>data <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;&#39;0x6030f0,0x0000000000000024,0x0000000000603110
</span><span style=color:#e6db74>0x603100,0x0000000000603130,0x0000000000000000
</span><span style=color:#e6db74>0x603110,0x0000000000000008,0x0000000000603190
</span><span style=color:#e6db74>0x603120,0x0000000000603150,0x0000000000000000
</span><span style=color:#e6db74>0x603130,0x0000000000000032,0x0000000000603170
</span><span style=color:#e6db74>0x603140,0x00000000006031b0,0x0000000000000000
</span><span style=color:#e6db74>0x603150,0x0000000000000016,0x0000000000603270
</span><span style=color:#e6db74>0x603160,0x0000000000603230,0x0000000000000000
</span><span style=color:#e6db74>0x603170,0x000000000000002d,0x00000000006031d0
</span><span style=color:#e6db74>0x603180,0x0000000000603290,0x0000000000000000
</span><span style=color:#e6db74>0x603190,0x0000000000000006,0x00000000006031f0
</span><span style=color:#e6db74>0x6031a0,0x0000000000603250,0x0000000000000000
</span><span style=color:#e6db74>0x6031b0,0x000000000000006b,0x0000000000603210
</span><span style=color:#e6db74>0x6031c0,0x00000000006032b0,0x0000000000000000
</span><span style=color:#e6db74>0x6031d0,0x0000000000000028,0x0000000000000000
</span><span style=color:#e6db74>0x6031e0,0x0000000000000000,0x0000000000000000
</span><span style=color:#e6db74>0x6031f0,0x0000000000000001,0x0000000000000000
</span><span style=color:#e6db74>0x603200,0x0000000000000000,0x0000000000000000
</span><span style=color:#e6db74>0x603210,0x0000000000000063,0x0000000000000000
</span><span style=color:#e6db74>0x603220,0x0000000000000000,0x0000000000000000
</span><span style=color:#e6db74>0x603230,0x0000000000000023,0x0000000000000000
</span><span style=color:#e6db74>0x603240,0x0000000000000000,0x0000000000000000
</span><span style=color:#e6db74>0x603250,0x0000000000000007,0x0000000000000000
</span><span style=color:#e6db74>0x603260,0x0000000000000000,0x0000000000000000
</span><span style=color:#e6db74>0x603270,0x0000000000000014,0x0000000000000000
</span><span style=color:#e6db74>0x603280,0x0000000000000000,0x0000000000000000
</span><span style=color:#e6db74>0x603290,0x000000000000002f,0x0000000000000000
</span><span style=color:#e6db74>0x6032a0,0x0000000000000000,0x0000000000000000
</span><span style=color:#e6db74>0x6032b0,0x00000000000003e9,0x0000000000000000
</span><span style=color:#e6db74>0x6032c0,0x0000000000000000,0x0000000000000000&#39;&#39;&#39;</span>

data_dict <span style=color:#f92672>=</span> {}
fin_dict <span style=color:#f92672>=</span> {}

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>data_collect</span>():
	data_list <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
	last_try <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
	<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> data_list:
		<span style=color:#75715e>#print i</span>
		x <span style=color:#f92672>=</span> i<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;,&#34;</span>)
		x <span style=color:#f92672>=</span> [int(i,<span style=color:#ae81ff>16</span>) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> x]
		<span style=color:#66d9ef>if</span> x[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>0x600000</span> <span style=color:#f92672>and</span> x[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span>:
			data_dict[x[<span style=color:#ae81ff>0</span>]] <span style=color:#f92672>=</span> [x[<span style=color:#ae81ff>1</span>],x[<span style=color:#ae81ff>2</span>],<span style=color:#ae81ff>0</span>]
			last_try <span style=color:#f92672>=</span> x[<span style=color:#ae81ff>0</span>]
		<span style=color:#66d9ef>else</span>:
			data_dict[last_try][<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> x[<span style=color:#ae81ff>1</span>]
	<span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> data_dict<span style=color:#f92672>.</span>values():
		<span style=color:#66d9ef>if</span> k[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
			<span style=color:#66d9ef>if</span> k[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
				fin_dict[k[<span style=color:#ae81ff>0</span>]] <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>]
			<span style=color:#66d9ef>else</span>:
				fin_dict[k[<span style=color:#ae81ff>0</span>]] <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>,data_dict[k[<span style=color:#ae81ff>2</span>]][<span style=color:#ae81ff>0</span>]]
		<span style=color:#66d9ef>else</span>:
			<span style=color:#66d9ef>if</span> k[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
				fin_dict[k[<span style=color:#ae81ff>0</span>]] <span style=color:#f92672>=</span> [data_dict[k[<span style=color:#ae81ff>1</span>]][<span style=color:#ae81ff>0</span>],<span style=color:#ae81ff>0</span>]
			<span style=color:#66d9ef>else</span>:
				fin_dict[k[<span style=color:#ae81ff>0</span>]] <span style=color:#f92672>=</span> [data_dict[k[<span style=color:#ae81ff>1</span>]][<span style=color:#ae81ff>0</span>],data_dict[k[<span style=color:#ae81ff>2</span>]][<span style=color:#ae81ff>0</span>]]
		
data_collect()


<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>func</span>(num,i):
	<span style=color:#66d9ef>if</span> num <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
		<span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
	<span style=color:#66d9ef>if</span> i <span style=color:#f92672>==</span> num:
		result <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
		<span style=color:#66d9ef>return</span> result
	<span style=color:#66d9ef>if</span> i<span style=color:#f92672>&gt;</span>num:
		next_num <span style=color:#f92672>=</span> fin_dict[num][<span style=color:#ae81ff>1</span>]
		result <span style=color:#f92672>=</span> func(next_num,i)
		result <span style=color:#f92672>=</span> result<span style=color:#f92672>+</span>result<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>
		<span style=color:#66d9ef>return</span> result
	<span style=color:#66d9ef>if</span> i<span style=color:#f92672>&lt;</span>num:
		next_num <span style=color:#f92672>=</span> fin_dict[num][<span style=color:#ae81ff>0</span>]
		result <span style=color:#f92672>=</span> func(next_num,i)
		result <span style=color:#f92672>*=</span> <span style=color:#ae81ff>2</span>
		<span style=color:#66d9ef>return</span> result

<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1000</span>):
	<span style=color:#66d9ef>if</span> func(<span style=color:#ae81ff>0x24</span>,i) <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>:
		<span style=color:#66d9ef>print</span> i
</code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://inten.kro1lsec.com/tags/csapplab/>CSAPPLAB</a></li><li><a href=https://inten.kro1lsec.com/tags/%E5%A4%A9%E9%97%AE%E4%B9%8B%E8%B7%AF/>å¤©é—®ä¹‹è·¯</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share [CSAPPLAB]Bomb Lab on twitter" href="https://twitter.com/intent/tweet/?text=%5bCSAPPLAB%5dBomb%20Lab&url=https%3a%2f%2finten.kro1lsec.com%2fpost%2fcsapplabbomb-lab%2f&hashtags=CSAPPLAB%2c%e5%a4%a9%e9%97%ae%e4%b9%8b%e8%b7%af"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [CSAPPLAB]Bomb Lab on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2finten.kro1lsec.com%2fpost%2fcsapplabbomb-lab%2f&title=%5bCSAPPLAB%5dBomb%20Lab&summary=%5bCSAPPLAB%5dBomb%20Lab&source=https%3a%2f%2finten.kro1lsec.com%2fpost%2fcsapplabbomb-lab%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [CSAPPLAB]Bomb Lab on reddit" href="https://reddit.com/submit?url=https%3a%2f%2finten.kro1lsec.com%2fpost%2fcsapplabbomb-lab%2f&title=%5bCSAPPLAB%5dBomb%20Lab"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [CSAPPLAB]Bomb Lab on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2finten.kro1lsec.com%2fpost%2fcsapplabbomb-lab%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [CSAPPLAB]Bomb Lab on whatsapp" href="https://api.whatsapp.com/send?text=%5bCSAPPLAB%5dBomb%20Lab%20-%20https%3a%2f%2finten.kro1lsec.com%2fpost%2fcsapplabbomb-lab%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [CSAPPLAB]Bomb Lab on telegram" href="https://telegram.me/share/url?text=%5bCSAPPLAB%5dBomb%20Lab&url=https%3a%2f%2finten.kro1lsec.com%2fpost%2fcsapplabbomb-lab%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://inten.kro1lsec.com/>intenã®blogğŸ¦</a></span>
<span>&#183;</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const d=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function c(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),c();return}const a=document.createRange();a.selectNodeContents(b);const d=window.getSelection();d.removeAllRanges(),d.addRange(a);try{document.execCommand('copy'),c()}catch(a){}d.removeRange(a)}),d.appendChild(a)})</script></body></html>